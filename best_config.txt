################################## FB15k237 ##################################

@@@@@@<<LX>>:@@@@@@
@@@@@@<LX:asymmetric>@@@@@@
CUDA_VISIBLE_DEVICES=0 python3 main.py -d fb15k237 -m complex_lx -a '{"embedding_dim":100, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 0.05 -b 1000 -x 500 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 1 -e 100
valid_m {'mrr': tensor(0.3517, device='cuda:0'), 'mr': tensor(170.8818, device='cuda:0'), 'hits10': tensor(0.5448, device='cuda:0'), 'hits1': tensor(0.2614, device='cuda:0')} test_m {'mrr': tensor(0.3459, device='cuda:0'), 'mr': tensor(185.4649, device='cuda:0'), 'hits10': tensor(0.5422, device='cuda:0'), 'hits1': tensor(0.2541, device='cuda:0')} valid {'mrr': tensor(0.4509, device='cuda:0'), 'mr': tensor(120.2482, device='cuda:0'), 'hits10': tensor(0.6474, device='cuda:0'), 'hits1': tensor(0.3571, device='cuda:0')} test {'mrr': tensor(0.4414, device='cuda:0'), 'mr': tensor(134.9239, device='cuda:0'), 'hits10': tensor(0.6426, device='cuda:0'), 'hits1': tensor(0.3443, device='cuda:0')} valid_e1 {'mrr': tensor(0.2525, device='cuda:0'), 'mr': tensor(221.5154, device='cuda:0'), 'hits10': tensor(0.4422, device='cuda:0'), 'hits1': tensor(0.1656, device='cuda:0')} test_e1 {'mrr': tensor(0.2505, device='cuda:0'), 'mr': tensor(236.0060, device='cuda:0'), 'hits10': tensor(0.4418, device='cuda:0'), 'hits1': tensor(0.1639, device='cuda:0')}
**2k**
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=500, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=100, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.05, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-09 15:24:09.916213', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-09 15:24:09.916213', verbose=1)
Best Model details:
valid_m {'mrr': tensor(0.3698, device='cuda:0'), 'mr': tensor(137.4180, device='cuda:0'), 'hits10': tensor(0.5711, device='cuda:0'), 'hits1': tensor(0.2751, device='cuda:0')} test_m {'mrr': tensor(0.3649, device='cuda:0'), 'mr': tensor(143.0360, device='cuda:0'), 'hits10': tensor(0.5677, device='cuda:0'), 'hits1': tensor(0.2700, device='cuda:0')} valid {'mrr': tensor(0.4687, device='cuda:0'), 'mr': tensor(92.7698, device='cuda:0'), 'hits10': tensor(0.6695, device='cuda:0'), 'hits1': tensor(0.3724, device='cuda:0')} test {'mrr': tensor(0.4601, device='cuda:0'), 'mr': tensor(97.4819, device='cuda:0'), 'hits10': tensor(0.6650, device='cuda:0'), 'hits1': tensor(0.3622, device='cuda:0')} valid_e1 {'mrr': tensor(0.2709, device='cuda:0'), 'mr': tensor(182.0663, device='cuda:0'), 'hits10': tensor(0.4727, device='cuda:0'), 'hits1': tensor(0.1778, device='cuda:0')} test_e1 {'mrr': tensor(0.2697, device='cuda:0'), 'mr': tensor(188.5902, device='cuda:0'), 'hits10': tensor(0.4704, device='cuda:0'), 'hits1': tensor(0.1778, device='cuda:0')}

@@@@@@<LX:symmetric>@@@@@@
Eval on valid |M| mrr:33.34|h10:52.71%|h1:24.29|e1| mrr:23.42|h10:41.92%|h1:14.91|e2| mrr:43.26|h10:63.51%|h1:33.68|TP-s error 16.806 |TP-o error 15.061 |
Eval on test  |M| mrr:32.70|h10:52.06%|h1:23.64|e1| mrr:23.06|h10:41.55%|h1:14.53|e2| mrr:42.35|h10:62.58%|h1:32.75|TP-s error 17.409 |TP-o error 15.186 |
**2k**
Namespace(avg_scores=1, batch_norm=0, batch_size=6000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.05, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-09 15:18:41.449854', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-09 15:18:41.449854', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.3604, device='cuda:0'), 'mr': tensor(144.7923, device='cuda:0'), 'hits10': tensor(0.5659, device='cuda:0'), 'hits1': tensor(0.2655, device='cuda:0')} test_m {'mrr': tensor(0.3545, device='cuda:0'), 'mr': tensor(148.5450, device='cuda:0'), 'hits10': tensor(0.5588, device='cuda:0'), 'hits1': tensor(0.2588, device='cuda:0')} valid {'mrr': tensor(0.4595, device='cuda:0'), 'mr': tensor(92.1641, device='cuda:0'), 'hits10': tensor(0.6692, device='cuda:0'), 'hits1': tensor(0.3604, device='cuda:0')} test {'mrr': tensor(0.4508, device='cuda:0'), 'mr': tensor(99.9369, device='cuda:0'), 'hits10': tensor(0.6595, device='cuda:0'), 'hits1': tensor(0.3508, device='cuda:0')} valid_e1 {'mrr': tensor(0.2613, device='cuda:0'), 'mr': tensor(197.4206, device='cuda:0'), 'hits10': tensor(0.4626, device='cuda:0'), 'hits1': tensor(0.1706, device='cuda:0')} test_e1 {'mrr': tensor(0.2583, device='cuda:0'), 'mr': tensor(197.1531, device='cuda:0'), 'hits10': tensor(0.4581, device='cuda:0'), 'hits1': tensor(0.1669, device='cuda:0')}
 
@@@@@@<<CX>>:@@@@@@
@@@@@@<CX:L2:>@@@@@@
main.py -d fb15k237 -m complex -a {"embedding_dim":100, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} -l crossentropy_loss_AllNeg -r 0.01 -g 0.000002 -b 6000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -e 500
valid_m {'mrr': tensor(0.3319, device='cuda:0'), 'mr': tensor(185.3078, device='cuda:0'), 'hits10': tensor(0.5219, device='cuda:0'), 'hits1': tensor(0.2431, device='cuda:0')} test_m {'mrr': tensor(0.3269, device='cuda:0'), 'mr': tensor(195.2299, device='cuda:0'), 'hits10': tensor(0.5205, device='cuda:0'), 'hits1': tensor(0.2377, device='cuda:0')} valid {'mrr': tensor(0.4336, device='cuda:0'), 'mr': tensor(127.9366, device='cuda:0'), 'hits10': tensor(0.6324, device='cuda:0'), 'hits1': tensor(0.3391, device='cuda:0')} test {'mrr': tensor(0.4263, device='cuda:0'), 'mr': tensor(138.2693, device='cuda:0'), 'hits10': tensor(0.6277, device='cuda:0'), 'hits1': tensor(0.3312, device='cuda:0')} valid_e1 {'mrr': tensor(0.2301, device='cuda:0'), 'mr': tensor(242.6790, device='cuda:0'), 'hits10': tensor(0.4113, device='cuda:0'), 'hits1': tensor(0.1471, device='cuda:0')} test_e1 {'mrr': tensor(0.2276, device='cuda:0'), 'mr': tensor(252.1904, device='cuda:0'), 'hits10': tensor(0.4132, device='cuda:0'), 'hits1': tensor(0.1442, device='cuda:0')}
g=2
main.py -d fb15k237 -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.01 -g 2 -b 10000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -e 500
{'valid_m': {'mrr': tensor(0.3456, device='cuda:0'), 'mr': tensor(187.6956, device='cuda:0'), 'hits10': tensor(0.5403, device='cuda:0'), 'hits1': tensor(0.2558, device='cuda:0')}, 'test_m': {'mrr': tensor(0.3391, device='cuda:0'), 'mr': tensor(203.8398, device='cuda:0'), 'hits10': tensor(0.5335, device='cuda:0'), 'hits1': tensor(0.2501, device='cuda:0')}, 'valid': {'mrr': tensor(0.4456, device='cuda:0'), 'mr': tensor(136.0286, device='cuda:0'), 'hits10': tensor(0.6463, device='cuda:0'), 'hits1': tensor(0.3507, device='cuda:0')}, 'test': {'mrr': tensor(0.4355, device='cuda:0'), 'mr': tensor(152.6017, device='cuda:0'), 'hits10': tensor(0.6362, device='cuda:0'), 'hits1': tensor(0.3410, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.2457, device='cuda:0'), 'mr': tensor(239.3626, device='cuda:0'), 'hits10': tensor(0.4343, device='cuda:0'), 'hits1': tensor(0.1609, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.2428, device='cuda:0'), 'mr': tensor(255.0779, device='cuda:0'), 'hits10': tensor(0.4309, device='cuda:0'), 'hits1': tensor(0.1591, device='cuda:0')}}

g=5
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=5.0, regularizer=2.0, resume_from_save=None, save_dir='/scratch/cse/phd/csz148211/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-14 22:08:12.261993', tflogs_dir='/scratch/cse/phd/csz148211/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-14 22:08:12.261993', verbose=1)
Eval on test  |M| mrr:33.73|h10:53.05%|h1:24.65|e1| mrr:23.74|h10:41.94%|h1:15.32|e2| mrr:43.73|h10:64.16%|h1:33.98|TP-s error 18.958 |TP-o error 14.678 |

g=10
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=10.0, regularizer=2.0, resume_from_save=None, save_dir='/scratch/cse/phd/csz148211/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-14 22:10:22.466683', tflogs_dir='/scratch/cse/phd/csz148211/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-14 22:10:22.466683', verbose=1)
Eval on test  |M| mrr:33.56|h10:52.91%|h1:24.53|e1| mrr:23.75|h10:41.96%|h1:15.33|e2| mrr:43.37|h10:63.86%|h1:33.73|TP-s error 18.704 |TP-o error 15.245 |

g=0.0005, b=100 (reg only by batch size)
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=5000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=300, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0005, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 13:17:50.847613', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 13:17:50.847613', verbose=1)
Eval on valid |M| mrr:35.40|h10:54.34%|h1:26.48|e1| mrr:25.36|h10:43.79%|h1:16.97|e2| mrr:45.44|h10:64.89%|h1:36.00|TP-s error 16.823 |TP-o error 14.314 |
Eval on test  |M| mrr:34.73|h10:53.53%|h1:25.87|e1| mrr:24.89|h10:43.01%|h1:16.49|e2| mrr:44.57|h10:64.04%|h1:35.25|TP-s error 17.507 |TP-o error 14.263 |

g=0.00005, b=1k (reg only by batch size)
main.py -d fb15k237 -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.00005 -b 1000 -x 500 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 800 -msg 'temp norm off:for embedding size'
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=500, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=800, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=5e-05, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 17:14:40.694319', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 17:14:40.694319', verbose=1)
Eval on valid |M| mrr:35.50|h10:54.68%|h1:26.63|e1| mrr:25.33|h10:44.12%|h1:16.88|e2| mrr:45.67|h10:65.24%|h1:36.38|TP-s error 16.561 |TP-o error 14.189 |
Eval on test  |M| mrr:34.90|h10:54.12%|h1:25.95|e1| mrr:25.20|h10:43.55%|h1:16.77|e2| mrr:44.61|h10:64.70%|h1:35.13|TP-s error 17.229 |TP-o error 14.497 |

g=0.005, b=1k (reg only by batch size)
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=500, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=800, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.005, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 21:23:11.042024', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 21:23:11.042024', verbose=1)
Eval on valid |M| mrr:34.79|h10:54.05%|h1:25.73|e1| mrr:24.48|h10:43.23%|h1:15.85|e2| mrr:45.09|h10:64.86%|h1:35.60|TP-s error 17.964 |TP-o error 14.924 |
Eval on test  |M| mrr:33.92|h10:53.75%|h1:24.73|e1| mrr:24.13|h10:43.13%|h1:15.46|e2| mrr:43.72|h10:64.38%|h1:34.00|TP-s error 18.631 |TP-o error 15.079 |

g=0.0005, b=1k
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=5000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=800, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0005, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 19:02:06.443899', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-25 19:02:06.443899', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.3530, device='cuda:0'), 'mr': tensor(206.3450, device='cuda:0'), 'hits10': tensor(0.5454, device='cuda:0'), 'hits1': tensor(0.2640, device='cuda:0')} test_m {'mrr': tensor(0.3480, device='cuda:0'), 'mr': tensor(226.9502, device='cuda:0'), 'hits10': tensor(0.5417, device='cuda:0'), 'hits1': tensor(0.2579, device='cuda:0')} valid {'mrr': tensor(0.4533, device='cuda:0'), 'mr': tensor(136.1566, device='cuda:0'), 'hits10': tensor(0.6518, device='cuda:0'), 'hits1': tensor(0.3579, device='cuda:0')} test {'mrr': tensor(0.4462, device='cuda:0'), 'mr': tensor(155.0748, device='cuda:0'), 'hits10': tensor(0.6456, device='cuda:0'), 'hits1': tensor(0.3511, device='cuda:0')} valid_e1 {'mrr': tensor(0.2527, device='cuda:0'), 'mr': tensor(276.5333, device='cuda:0'), 'hits10': tensor(0.4390, device='cuda:0'), 'hits1': tensor(0.1701, device='cuda:0')} test_e1 {'mrr': tensor(0.2497, device='cuda:0'), 'mr': tensor(298.8255, device='cuda:0'), 'hits10': tensor(0.4378, device='cuda:0'), 'hits1': tensor(0.1646, device='cuda:0')}

@@@@@@<CX:L3:>@@@@@@
g=0.5
valid_m {'mrr': tensor(0.3331, device='cuda:0'), 'mr': tensor(220.9485, device='cuda:0'), 'hits10': tensor(0.5239, device='cuda:0'), 'hits1': tensor(0.2446, device='cuda:0')} test_m {'mrr': tensor(0.3275, device='cuda:0'), 'mr': tensor(243.0398, device='cuda:0'), 'hits10': tensor(0.5193, device='cuda:0'), 'hits1': tensor(0.2385, device='cuda:0')} valid {'mrr': tensor(0.4328, device='cuda:0'), 'mr': tensor(158.4747, device='cuda:0'), 'hits10': tensor(0.6309, device='cuda:0'), 'hits1': tensor(0.3394, device='cuda:0')} test {'mrr': tensor(0.4234, device='cuda:0'), 'mr': tensor(180.2953, device='cuda:0'), 'hits10': tensor(0.6250, device='cuda:0'), 'hits1': tensor(0.3287, device='cuda:0')} valid_e1 {'mrr': tensor(0.2333, device='cuda:0'), 'mr': tensor(283.4223, device='cuda:0'), 'hits10': tensor(0.4169, device='cuda:0'), 'hits1': tensor(0.1498, device='cuda:0')} test_e1 {'mrr': tensor(0.2315, device='cuda:0'), 'mr': tensor(305.7843, device='cuda:0'), 'hits10': tensor(0.4137, device='cuda:0'), 'hits1': tensor(0.1483, device='cuda:0')}

g=0.005
main.py -d fb15k237 -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0,"clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 0.005 -b 1000 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 0 -e 1000
{'valid_m': {'mrr': tensor(0.3600, device='cuda:0'), 'mr': tensor(178.4094, device='cuda:0'), 'hits10': tensor(0.5543, device='cuda:0'), 'hits1': tensor(0.2681, device='cuda:0')}, 'test_m': {'mrr': tensor(0.3540, device='cuda:0'), 'mr': tensor(192.8387, device='cuda:0'), 'hits10': tensor(0.5501, device='cuda:0'), 'hits1': tensor(0.2615, device='cuda:0')}, 'valid': {'mrr': tensor(0.4616, device='cuda:0'), 'mr': tensor(117.5839, device='cuda:0'), 'hits10': tensor(0.6594, device='cuda:0'), 'hits1': tensor(0.3658, device='cuda:0')}, 'test': {'mrr': tensor(0.4512, device='cuda:0'), 'mr': tensor(127.8869, device='cuda:0'), 'hits10': tensor(0.6544, device='cuda:0'), 'hits1': tensor(0.3538, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.2585, device='cuda:0'), 'mr': tensor(239.2350, device='cuda:0'), 'hits10': tensor(0.4491, device='cuda:0'), 'hits1': tensor(0.1704, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.2569, device='cuda:0'), 'mr': tensor(257.7906, device='cuda:0'), 'hits10': tensor(0.4457, device='cuda:0'), 'hits1': tensor(0.1691, device='cuda:0')}}

g=0.05
main.py -d fb15k237 -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 0.05 -b 100 -x 5000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 0 -e 200
{'valid_m': {'mrr': tensor(0.3637, device='cuda:0'), 'mr': tensor(158.0170, device='cuda:0'), 'hits10': tensor(0.5646, device='cuda:0'), 'hits1': tensor(0.2689, device='cuda:0')}, 'test_m': {'mrr': tensor(0.3586, device='cuda:0'), 'mr': tensor(169.2153, device='cuda:0'), 'hits10': tensor(0.5572, device='cuda:0'), 'hits1': tensor(0.2645, device='cuda:0')}, 'valid': {'mrr': tensor(0.4636, device='cuda:0'), 'mr': tensor(101.9311, device='cuda:0'), 'hits10': tensor(0.6669, device='cuda:0'), 'hits1': tensor(0.3658, device='cuda:0')}, 'test': {'mrr': tensor(0.4554, device='cuda:0'), 'mr': tensor(110.7473, device='cuda:0'), 'hits10': tensor(0.6571, device='cuda:0'), 'hits1': tensor(0.3577, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.2638, device='cuda:0'), 'mr': tensor(214.1030, device='cuda:0'), 'hits10': tensor(0.4623, device='cuda:0'), 'hits1': tensor(0.1720, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.2618, device='cuda:0'), 'mr': tensor(227.6834, device='cuda:0'), 'hits10': tensor(0.4572, device='cuda:0'), 'hits1': tensor(0.1714, device='cuda:0')}}


@@@@@@<CX:WP:200neg>@@@@@@
Eval on valid |M| mrr:32.01|h10:51.35%|h1:23.01|e1| mrr:22.17|h10:40.09%|h1:14.02|e2| mrr:41.85|h10:62.62%|h1:31.99|TP-s error 18.044 |TP-o error 16.709 |
Eval on test  |M| mrr:31.34|h10:50.94%|h1:22.24|e1| mrr:21.88|h10:39.70%|h1:13.75|e2| mrr:40.80|h10:62.18%|h1:30.72|TP-s error 18.782 |TP-o error 16.584 |
main.py -d fb15k237 -m complex -a '{"embedding_dim":2000, "batch_norm":0, "unit_reg":0}'  -l crossentropy_loss_bothNegSep -r 0.1 -g 0.005 -b 800 -x 500 -n 200 -v 1 -q 1 -y 10 -g_reg 2 -e 800 -msg 'temp norm off:for embedding size'
Namespace(avg_scores=0, batch_norm=0, batch_size=800, data_repository_root='data', dataset='fb15k237', debug=1, eval_batch_size=10, eval_every_x_mini_batches=500, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_bothNegSep', max_epochs=800, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=200, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.005, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_bothNegSep run on fb15k237 starting from 2020-04-30 11:58:42.393516', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_bothNegSep run on fb15k237 starting from 2020-04-30 11:58:42.393516', verbose=1)

softmax
main.py -d fb15k237 -m complex -a '{"embedding_dim":2000, "batch_norm":0, "unit_reg":0}'  -l softmax_loss_wopos -r 0.1 -g 0.005 -b 800 -x 500 -n 200 -v 1 -q 1 -y 10 -g_reg 2 -e 800
Eval on valid |M| mrr:27.73|h10:44.53%|h1:20.01|e1| mrr:17.68|h10:32.34%|h1:10.98|e2| mrr:37.77|h10:56.73%|h1:29.04|time     7|TP-s error 23.638 |TP-o error 18.916 |
Eval on test  |M| mrr:27.18|h10:43.91%|h1:19.37|e1| mrr:17.43|h10:31.63%|h1:10.75|e2| mrr:36.94|h10:56.18%|h1:27.99|time     8|TP-s error 23.888 |TP-o error 19.007 |
 

@@@@@@<SimplIE>:FSM@@@@@@
Namespace(avg_scores=1, batch_norm=0, batch_size=10000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.05, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.1, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-08 17:40:54.999859', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-08 17:40:54.999859', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.3371, device='cuda:0'), 'mr': tensor(231.6658, device='cuda:0'), 'hits10': tensor(0.5212, device='cuda:0'), 'hits1': tensor(0.2497, device='cuda:0')} test_m {'mrr': tensor(0.3303, device='cuda:0'), 'mr': tensor(248.9721, device='cuda:0'), 'hits10': tensor(0.5165, device='cuda:0'), 'hits1': tensor(0.2421, device='cuda:0')} valid {'mrr': tensor(0.4389, device='cuda:0'), 'mr': tensor(172.8907, device='cuda:0'), 'hits10': tensor(0.6293, device='cuda:0'), 'hits1': tensor(0.3461, device='cuda:0')} test {'mrr': tensor(0.4285, device='cuda:0'), 'mr': tensor(183.4221, device='cuda:0'), 'hits10': tensor(0.6224, device='cuda:0'), 'hits1': tensor(0.3342, device='cuda:0')} valid_e1 {'mrr': tensor(0.2353, device='cuda:0'), 'mr': tensor(290.4410, device='cuda:0'), 'hits10': tensor(0.4130, device='cuda:0'), 'hits1': tensor(0.1534, device='cuda:0')} test_e1 {'mrr': tensor(0.2320, device='cuda:0'), 'mr': tensor(314.5221, device='cuda:0'), 'hits10': tensor(0.4107, device='cuda:0'), 'hits1': tensor(0.1501, device='cuda:0')}

@@@@@@<SimplIE>:FSM:asymmetric@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=10000, data_repository_root='data', dataset='fb15k237', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=3.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-09 16:50:21.020363', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k237 starting from 2020-04-09 16:50:21.020363', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.3232, device='cuda:0'), 'mr': tensor(228.0288, device='cuda:0'), 'hits10': tensor(0.5117, device='cuda:0'), 'hits1': tensor(0.2345, device='cuda:0')} test_m {'mrr': tensor(0.3182, device='cuda:0'), 'mr': tensor(244.2076, device='cuda:0'), 'hits10': tensor(0.5096, device='cuda:0'), 'hits1': tensor(0.2286, device='cuda:0')} valid {'mrr': tensor(0.4245, device='cuda:0'), 'mr': tensor(156.9782, device='cuda:0'), 'hits10': tensor(0.6248, device='cuda:0'), 'hits1': tensor(0.3284, device='cuda:0')} test {'mrr': tensor(0.4175, device='cuda:0'), 'mr': tensor(168.6142, device='cuda:0'), 'hits10': tensor(0.6209, device='cuda:0'), 'hits1': tensor(0.3201, device='cuda:0')} valid_e1 {'mrr': tensor(0.2219, device='cuda:0'), 'mr': tensor(299.0795, device='cuda:0'), 'hits10': tensor(0.3987, device='cuda:0'), 'hits1': tensor(0.1406, device='cuda:0')} test_e1 {'mrr': tensor(0.2189, device='cuda:0'), 'mr': tensor(319.8010, device='cuda:0'), 'hits10': tensor(0.3982, device='cuda:0'), 'hits1': tensor(0.1371, device='cuda:0')}


@@@@@@<SimplIE>:FSM:Symmetric@@@@@@
 main.py -d fb15k237 -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.05 -g 0.1 -b 10000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1
{'valid_m': {'mrr': tensor(0.3451, device='cuda:0'), 'mr': tensor(214.1122, device='cuda:0'), 'hits10': tensor(0.5317, device='cuda:0'), 'hits1': tensor(0.2581, device='cuda:0')}, 'test_m': {'mrr': tensor(0.3385, device='cuda:0'), 'mr': tensor(231.4873, device='cuda:0'), 'hits10': tensor(0.5264, device='cuda:0'), 'hits1': tensor(0.2499, device='cuda:0')}, 'valid': {'mrr': tensor(0.4468, device='cuda:0'), 'mr': tensor(152.9173, device='cuda:0'), 'hits10': tensor(0.6390, device='cuda:0'), 'hits1': tensor(0.3555, device='cuda:0')}, 'test': {'mrr': tensor(0.4384, device='cuda:0'), 'mr': tensor(171.4662, device='cuda:0'), 'hits10': tensor(0.6312, device='cuda:0'), 'hits1': tensor(0.3454, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.2433, device='cuda:0'), 'mr': tensor(275.3069, device='cuda:0'), 'hits10': tensor(0.4245, device='cuda:0'), 'hits1': tensor(0.1606, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.2386, device='cuda:0'), 'mr': tensor(291.5085, device='cuda:0'), 'hits10': tensor(0.4215, device='cuda:0'), 'hits1': tensor(0.1544, device='cuda:0')}}
{'valid_m': {'mrr': tensor(0.3443, device='cuda:0'), 'mr': tensor(216.2749, device='cuda:0'), 'hits10': tensor(0.5326, device='cuda:0'), 'hits1': tensor(0.2568, device='cuda:0')}, 'test_m': {'mrr': tensor(0.3382, device='cuda:0'), 'mr': tensor(233.3738, device='cuda:0'), 'hits10': tensor(0.5258, device='cuda:0'), 'hits1': tensor(0.2499, device='cuda:0')}, 'valid': {'mrr': tensor(0.4465, device='cuda:0'), 'mr': tensor(154.1492, device='cuda:0'), 'hits10': tensor(0.6393, device='cuda:0'), 'hits1': tensor(0.3555, device='cuda:0')}, 'test': {'mrr': tensor(0.4378, device='cuda:0'), 'mr': tensor(172.9687, device='cuda:0'), 'hits10': tensor(0.6292, device='cuda:0'), 'hits1': tensor(0.3454, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.2421, device='cuda:0'), 'mr': tensor(278.4006, device='cuda:0'), 'hits10': tensor(0.4258, device='cuda:0'), 'hits1': tensor(0.1581, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.2387, device='cuda:0'), 'mr': tensor(293.7789, device='cuda:0'), 'hits10': tensor(0.4225, device='cuda:0'), 'hits1': tensor(0.1545, device='cuda:0')}}
main.py -d fb15k237 -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.05 -g 0.01 -b 10000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1

#batch only norm
main.py -d fb15k237 -m SimplIE_v1 -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 0.00001 -b 1000 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1
Eval on valid |**********| 100.0% |M| mrr:34.82|h10:53.69%|h1:25.93|e1| mrr:24.64|h10:42.95%|h1:16.22|e2| mrr:45.00|h10:64.44%|h1:35.63|TP-s error 18.922 |TP-o error 14.554 |
Eval on test  |**********| 100.0% |M| mrr:34.39|h10:53.25%|h1:25.53|e1| mrr:24.48|h10:42.79%|h1:16.03|e2| mrr:44.31|h10:63.71%|h1:35.03|TP-s error 19.525 |TP-o error 14.458 |
{'valid_m': {'mrr': tensor(0.3482, device='cuda:0'), 'mr': tensor(206.4501, device='cuda:0'), 'hits10': tensor(0.5369, device='cuda:0'), 'hits1': tensor(0.2593, device='cuda:0')}, 'test_m': {'mrr': tensor(0.3439, device='cuda:0'), 'mr': tensor(225.0606, device='cuda:0'), 'hits10': tensor(0.5325, device='cuda:0'), 'hits1': tensor(0.2553, device='cuda:0')}, 'valid': {'mrr': tensor(0.4500, device='cuda:0'), 'mr': tensor(143.6650, device='cuda:0'), 'hits10': tensor(0.6444, device='cuda:0'), 'hits1': tensor(0.3563, device='cuda:0')}, 'test': {'mrr': tensor(0.4431, device='cuda:0'), 'mr': tensor(158.9618, device='cuda:0'), 'hits10': tensor(0.6371, device='cuda:0'), 'hits1': tensor(0.3503, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.2464, device='cuda:0'), 'mr': tensor(269.2351, device='cuda:0'), 'hits10': tensor(0.4295, device='cuda:0'), 'hits1': tensor(0.1622, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.2448, device='cuda:0'), 'mr': tensor(291.1593, device='cuda:0'), 'hits10': tensor(0.4279, device='cuda:0'), 'hits1': tensor(0.1603, device='cuda:0')}}

################################## FB15k ##################################
@@@@@@<LX: Symmetric>@@@@@@
Namespace(avg_scores=1, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=300, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0025, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 02:29:25.373928', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 02:29:25.373928', verbose=1)
Eval on valid |M| mrr:85.45|h10:90.90%|h1:82.56|e1| mrr:83.22|h10:88.67%|h1:80.36|e2| mrr:87.68|h10:93.12%|h1:84.77|TP-s error 4.432 |TP-o error 3.398 |
Eval on test  |M| mrr:85.45|h10:90.94%|h1:82.54|e1| mrr:83.22|h10:88.73%|h1:80.31|e2| mrr:87.69|h10:93.16%|h1:84.78|TP-s error 4.589 |TP-o error 3.364 |
 
@@@@@@<LX:Asymmetric>@@@@@@
main.py -d fb15k -m complex_lx -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0}' -l crossentropy_loss_AllNeg -r 0.01 -g 0.0025 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 100 -g_reg 3 -inv 1 -avg 0  -e 300
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=300, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0025, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 02:29:40.085937', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 02:29:40.085937', verbose=1)
Eval on valid |M| mrr:85.15|h10:90.93%|h1:82.08|e1| mrr:82.87|h10:88.66%|h1:79.81|e2| mrr:87.44|h10:93.20%|h1:84.35|TP-s error 4.354 |TP-o error 3.458 |
Eval on test  |M| mrr:85.27|h10:90.98%|h1:82.18|e1| mrr:83.10|h10:88.73%|h1:80.07|e2| mrr:87.45|h10:93.22%|h1:84.29|TP-s error 4.447 |TP-o error 3.564 |
 
@@@@@@<CX:FSM:L2>@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=1500, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=100, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=3.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-10 00:23:36.850513', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-10 00:23:36.850513', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.8463, device='cuda:0'), 'mr': tensor(39.6652, device='cuda:0'), 'hits10': tensor(0.9094, device='cuda:0'), 'hits1': tensor(0.8123, device='cuda:0')} test_m {'mrr': tensor(0.8464, device='cuda:0'), 'mr': tensor(36.5953, device='cuda:0'), 'hits10': tensor(0.9100, device='cuda:0'), 'hits1': tensor(0.8114, device='cuda:0')} valid {'mrr': tensor(0.8686, device='cuda:0'), 'mr': tensor(30.4347, device='cuda:0'), 'hits10': tensor(0.9316, device='cuda:0'), 'hits1': tensor(0.8344, device='cuda:0')} test {'mrr': tensor(0.8687, device='cuda:0'), 'mr': tensor(27.9294, device='cuda:0'), 'hits10': tensor(0.9327, device='cuda:0'), 'hits1': tensor(0.8331, device='cuda:0')} valid_e1 {'mrr': tensor(0.8240, device='cuda:0'), 'mr': tensor(48.8957, device='cuda:0'), 'hits10': tensor(0.8872, device='cuda:0'), 'hits1': tensor(0.7903, device='cuda:0')} test_e1 {'mrr': tensor(0.8242, device='cuda:0'), 'mr': tensor(45.2613, device='cuda:0'), 'hits10': tensor(0.8872, device='cuda:0'), 'hits1': tensor(0.7897, device='cuda:0')}

Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=5.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 12:30:52.095728', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 12:30:52.095728', verbose=1)
Eval on valid |M| mrr:85.74|h10:91.11%|h1:82.89|e1| mrr:83.46|h10:88.83%|h1:80.63|e2| mrr:88.03|h10:93.39%|h1:85.14|TP-s error 4.464 |TP-o error 3.102 |
Eval on test  |M| mrr:85.78|h10:91.18%|h1:82.83|e1| mrr:83.52|h10:88.93%|h1:80.61|e2| mrr:88.03|h10:93.42%|h1:85.06|TP-s error 4.638 |TP-o error 3.176 |
 
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0 learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=2.5, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 12:27:28.245130', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 12:27:28.245130', verbose=1)
Eval on valid |M| mrr:85.71|h10:91.01%|h1:82.96|e1| mrr:83.43|h10:88.80%|h1:80.70|e2| mrr:87.99|h10:93.23%|h1:85.22|TP-s error 4.720 |TP-o error 3.192 |
Eval on test  |M| mrr:85.76|h10:91.08%|h1:82.97|e1| mrr:83.50|h10:88.86%|h1:80.74|e2| mrr:88.01|h10:93.30%|h1:85.21|TP-s error 4.752 |TP-o error 3.203 |
 
@@@@@@<CX:FSM:L3>@@@@@@
Eval on valid |M| mrr:85.46|h10:90.91%|h1:82.63|e1| mrr:83.17|h10:88.64%|h1:80.35|e2| mrr:87.76|h10:93.17%|h1:84.92|TP-s error 4.816 |TP-o error 3.176 |
Eval on test  |M| mrr:85.52|h10:90.98%|h1:82.66|e1| mrr:83.27|h10:88.74%|h1:80.43|e2| mrr:87.77|h10:93.22%|h1:84.88|TP-s error 4.738 |TP-o error 3.218 |

Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0025, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 12:09:03.954186', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-13 12:09:03.954186', verbose=1)
Eval on valid |M| mrr:85.47|h10:90.91%|h1:82.65|e1| mrr:83.18|h10:88.64%|h1:80.36|e2| mrr:87.77|h10:93.18%|h1:84.95|TP-s error 4.830 |TP-o error 3.168 |         
Eval on test  |M| mrr:85.52|h10:90.98%|h1:82.66|e1| mrr:83.27|h10:88.73%|h1:80.44|e2| mrr:87.78|h10:93.23%|h1:84.89|TP-s error 4.740 |TP-o error 3.213 |
 
@@@@@@<CX:WP:200neg>@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.01, loss='crossentropy_loss_bothNegSep', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=200, oov_entity='1', optimizer='Adagrad', regularization_coefficient=5.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_bothNegSep run on fb15k starting from 2020-04-30 03:49:18.098916', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_bothNegSep run on fb15k starting from 2020-04-30 03:49:18.098916', verbose=1)
Eval on valid |M| mrr:81.47|h10:91.04%|h1:75.02|e1| mrr:79.00|h10:88.63%|h1:72.53|e2| mrr:83.94|h10:93.45%|h1:77.51|TP-s error 6.788 |TP-o error 5.374 |
Eval on test  |M| mrr:81.43|h10:91.11%|h1:74.80|e1| mrr:79.05|h10:88.68%|h1:72.43|e2| mrr:83.80|h10:93.53%|h1:77.16|TP-s error 6.721 |TP-o error 5.441 |

softmax
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=100, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.01, loss='softmax_loss_wopos', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=200, oov_entity='1', optimizer='Adagrad', regularization_coefficient=5.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} softmax_loss_wopos run on fb15k starting from 2020-05-01 01:24:41.649780', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} softmax_loss_wopos run on fb15k starting from 2020-05-01 01:24:41.649780', verbose=1)
Eval on valid |M| mrr:42.29|h10:65.95%|h1:30.32|e1| mrr:39.00|h10:62.67%|h1:27.09|e2| mrr:45.58|h10:69.23%|h1:33.55|TP-s error 20.280 |TP-o error 17.402 |
Eval on test  |M| mrr:42.25|h10:65.99%|h1:30.25|e1| mrr:39.28|h10:62.96%|h1:27.28|e2| mrr:45.22|h10:69.02%|h1:33.22|TP-s error 20.797 |TP-o error 17.408 |

@@@@@@<SimplIE>:FSM@@@@@@
main.py -d fb15k -m SimplIE -a {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} -l crossentropy_loss_AllNeg -r 0.05 -g 2 -b 3000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 1 -avg 1
Eval on valid |**********| 100.0% |M| mrr:83.59|h10:90.44%|h1:79.79|e1| mrr:80.98|h10:87.96%|h1:77.25|e2| mrr:86.20|h10:92.92%|h1:82.33|TP-s error 5.522 |TP-o error 3.954 |||
Eval on test  |**********| 100.0% |M| mrr:83.52|h10:90.53%|h1:79.60|e1| mrr:80.96|h10:88.00%|h1:77.13|e2| mrr:86.08|h10:93.05%|h1:82.07|TP-s error 5.559 |TP-o error 3.938 ||

@@@@@@<SimplIE>:FSM:Asymmetric@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=10000, data_repository_root='data', dataset='fb15k', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.05, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=3.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-08 21:48:43.525184', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on fb15k starting from 2020-04-08 21:48:43.525184', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.8359, device='cuda:0'), 'mr': tensor(42.7543, device='cuda:0'), 'hits10': tensor(0.9044, device='cuda:0'), 'hits1': tensor(0.7979, device='cuda:0')} test_m {'mrr': tensor(0.8352, device='cuda:0'), 'mr': tensor(42.1948, device='cuda:0'), 'hits10': tensor(0.9053, device='cuda:0'), 'hits1': tensor(0.7960, device='cuda:0')} valid {'mrr': tensor(0.8620, device='cuda:0'), 'mr': tensor(33.1495, device='cuda:0'), 'hits10': tensor(0.9292, device='cuda:0'), 'hits1': tensor(0.8233, device='cuda:0')} test {'mrr': tensor(0.8608, device='cuda:0'), 'mr': tensor(32.9388, device='cuda:0'), 'hits10': tensor(0.9305, device='cuda:0'), 'hits1': tensor(0.8207, device='cuda:0')} valid_e1 {'mrr': tensor(0.8098, device='cuda:0'), 'mr': tensor(52.3590, device='cuda:0'), 'hits10': tensor(0.8796, device='cuda:0'), 'hits1': tensor(0.7725, device='cuda:0')} test_e1 {'mrr': tensor(0.8096, device='cuda:0'), 'mr': tensor(51.4508, device='cuda:0'), 'hits10': tensor(0.8800, device='cuda:0'), 'hits1': tensor(0.7713, device='cuda:0')} 

@@@@@@<SimplIE>:FSM:Symmetric@@@@@@
main.py -d fb15k -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 05 -g 3 -b 10000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1
Eval on valid |M| mrr:84.84|h10:90.83%|h1:81.51|e1| mrr:82.43|h10:88.48%|h1:79.13|e2| mrr:87.25|h10:93.17%|h1:83.89|time    19|TP-s error 4.708 |TP-o error 3.528 |
Eval on test  |M| mrr:84.90|h10:90.93%|h1:81.50|e1| mrr:82.55|h10:88.57%|h1:79.20|e2| mrr:87.25|h10:93.28%|h1:83.79|time    22|TP-s error 4.694 |TP-o error 3.608 |


################################## WN18 ##################################
@@@@@@<LX: Asymmetric>@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=1500, data_repository_root='data', dataset='wn18', debug=0, eval_batch_size=100, eval_every_x_mini_batches=100, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.05, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18 starting from 2020-04-09 11:27:29.736017', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18 starting from 2020-04-09 11:27:29.736017', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.9487, device='cuda:0'), 'mr': tensor(221.0902, device='cuda:0'), 'hits10': tensor(0.9585, device='cuda:0'), 'hits1': tensor(0.9428, device='cuda:0')} test_m {'mrr': tensor(0.9507, device='cuda:0'), 'mr': tensor(174.4855, device='cuda:0'), 'hits10': tensor(0.9629, device='cuda:0'), 'hits1': tensor(0.9442, device='cuda:0')} valid {'mrr': tensor(0.9501, device='cuda:0'), 'mr': tensor(218.0442, device='cuda:0'), 'hits10': tensor(0.9578, device='cuda:0'), 'hits1': tensor(0.9454, device='cuda:0')} test {'mrr': tensor(0.9502, device='cuda:0'), 'mr': tensor(184.3218, device='cuda:0'), 'hits10': tensor(0.9628, device='cuda:0'), 'hits1': tensor(0.9440, device='cuda:0')} valid_e1 {'mrr': tensor(0.9473, device='cuda:0'), 'mr': tensor(224.1362, device='cuda:0'), 'hits10': tensor(0.9592, device='cuda:0'), 'hits1': tensor(0.9402, device='cuda:0')} test_e1 {'mrr': tensor(0.9511, device='cuda:0'), 'mr': tensor(164.6493, device='cuda:0'), 'hits10': tensor(0.9630, device='cuda:0'), 'hits1': tensor(0.9444, device='cuda:0')}

@@@@@@<LX: Symmetric>@@@@@@
Eval on valid |**********| 100.0% |M| mrr:94.64|h10:95.84%|h1:93.93|e1| mrr:94.50|h10:95.90%|h1:93.68|e2| mrr:94.77|h10:95.78%|h1:94.18|time     1|TP-s error 6.320 |TP-o error 5.820 |
Eval on test  |**********| 100.0% |M| mrr:94.85|h10:96.21%|h1:94.09|e1| mrr:94.90|h10:96.22%|h1:94.14|e2| mrr:94.80|h10:96.20%|h1:94.04|time     1|TP-s error 5.860 |TP-o error 5.960 |
Namespace(avg_scores=1, batch_norm=0, batch_size=500, data_repository_root='data', dataset='wn18', debug=0, eval_batch_size=100, eval_every_x_mini_batches=100, gradient_clip=None, hooks=[], inverse=1, learning_$
ate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', opt$
mizer='Adagrad', regularization_coefficient=0.05, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0}
 crossentropy_loss_AllNeg run on wn18 starting from 2020-04-09 22:23:15.720047', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, 

@@@@@@<CX: FSM: L2>@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='wn18', debug=0, eval_batch_size=100, eval_every_x_mini_batches=100, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.01, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=3.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18 starting from 2020-04-10 00:34:05.434024', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18 starting from 2020-04-10 00:34:05.434024', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.9438, device='cuda:0'), 'mr': tensor(588.1321, device='cuda:0'), 'hits10': tensor(0.9498, device='cuda:0'), 'hits1': tensor(0.9401, device='cuda:0')} test_m {'mrr': tensor(0.9438, device='cuda:0'), 'mr': tensor(538.4071, device='cuda:0'), 'hits10': tensor(0.9500, device='cuda:0'), 'hits1': tensor(0.9401, device='cuda:0')} valid {'mrr': tensor(0.9446, device='cuda:0'), 'mr': tensor(607.3693, device='cuda:0'), 'hits10': tensor(0.9504, device='cuda:0'), 'hits1': tensor(0.9412, device='cuda:0')} test {'mrr': tensor(0.9441, device='cuda:0'), 'mr': tensor(568.0372, device='cuda:0'), 'hits10': tensor(0.9490, device='cuda:0'), 'hits1': tensor(0.9410, device='cuda:0')} valid_e1 {'mrr': tensor(0.9430, device='cuda:0'), 'mr': tensor(568.8950, device='cuda:0'), 'hits10': tensor(0.9492, device='cuda:0'), 'hits1': tensor(0.9390, device='cuda:0')} test_e1 {'mrr': tensor(0.9436, device='cuda:0'), 'mr': tensor(508.7770, device='cuda:0'), 'hits10': tensor(0.9510, device='cuda:0'), 'hits1': tensor(0.9392, device='cuda:0')}
 
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='wn18', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, lear
ning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=200, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=
0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=10.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "ba
tch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18 starting from 2020-04-14 19:13:46.272065', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim"
:2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18 starting from 2020-04-14 19:13:46.272065', verbose=1)
Eval on valid |M| mrr:94.81|h10:95.44%|h1:94.41|e1| mrr:94.77|h10:95.44%|h1:94.36|e2| mrr:94.85|h10:95.44%|h1:94.46|TP-s error 5.640 |TP-o error 5.540 |
Eval on test  |M| mrr:94.96|h10:95.76%|h1:94.49|e1| mrr:94.99|h10:95.82%|h1:94.48|e2| mrr:94.93|h10:95.70%|h1:94.50|TP-s error 5.520 |TP-o error 5.500 |

g=20
main.py -d wn18 -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 20 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 200
{'valid_m': {'mrr': tensor(0.9478, device='cuda:0'), 'mr': tensor(336.6595, device='cuda:0'), 'hits10': tensor(0.9542, device='cuda:0'), 'hits1': tensor(0.9439, device='cuda:0')}, 'test_m': {'mrr': tensor(0.9491, device='cuda:0'), 'mr': tensor(298.9966, device='cuda:0'), 'hits10': tensor(0.9569, device='cuda:0'), 'hits1': tensor(0.9448, device='cuda:0')}, 'valid': {'mrr': tensor(0.9477, device='cuda:0'), 'mr': tensor(360.0382, device='cuda:0'), 'hits10': tensor(0.9538, device='cuda:0'), 'hits1': tensor(0.9440, device='cuda:0')}, 'test': {'mrr': tensor(0.9492, device='cuda:0'), 'mr': tensor(299.9698, device='cuda:0'), 'hits10': tensor(0.9564, device='cuda:0'), 'hits1': tensor(0.9454, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.9479, device='cuda:0'), 'mr': tensor(313.2808, device='cuda:0'), 'hits10': tensor(0.9546, device='cuda:0'), 'hits1': tensor(0.9438, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.9489, device='cuda:0'), 'mr': tensor(298.0235, device='cuda:0'), 'hits10': tensor(0.9574, device='cuda:0'), 'hits1': tensor(0.9442, device='cuda:0')}}

g=40


@@@@@@<CX:FSM:L3>@@@@@@
main.py -d wn18 -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 0.05 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 0 -avg 0 -e 200
Eval on valid |M| mrr:94.99|h10:95.87%|h1:94.52|e1| mrr:94.90|h10:95.90%|h1:94.36|e2| mrr:95.09|h10:95.84%|h1:94.68| TP-s error 5.640 |TP-o error 5.320
Eval on test  |M| mrr:95.17|h10:96.30%|h1:94.60|e1| mrr:95.20|h10:96.30%|h1:94.62|e2| mrr:95.15|h10:96.30%|h1:94.58| TP-s error 5.380 |TP-o error 5.420
 
{'valid_m': {'mrr': tensor(0.9499, device='cuda:0'), 'mr': tensor(236.4310, device='cuda:0'), 'hits10': tensor(0.9587, device='cuda:0'), 'hits1': tensor(0.9452, device='cuda:0')}, 'test_m': {'mrr': tensor(0.9517, device='cuda:0'), 'mr': tensor(188.0969, device='cuda:0'), 'hits10': tensor(0.9630, device='cuda:0'), 'hits1': tensor(0.9460, device='cuda:0')}, 'valid': {'mrr': tensor(0.9509, device='cuda:0'), 'mr': tensor(234.4067, device='cuda:0'), 'hits10': tensor(0.9584, device='cuda:0'), 'hits1': tensor(0.9468, device='cuda:0')}, 'test': {'mrr': tensor(0.9515, device='cuda:0'), 'mr': tensor(207.2502, device='cuda:0'), 'hits10': tensor(0.9630, device='cuda:0'), 'hits1': tensor(0.9458, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.9490, device='cuda:0'), 'mr': tensor(238.4554, device='cuda:0'), 'hits10': tensor(0.9590, device='cuda:0'), 'hits1': tensor(0.9436, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.9520, device='cuda:0'), 'mr': tensor(168.9436, device='cuda:0'), 'hits10': tensor(0.9630, device='cuda:0'), 'hits1': tensor(0.9462, device='cuda:0')}}


@@@@@@<CX:WP:200neg>@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='wn18', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_bothNegSep', 
max_epochs=200, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=200, oov_entity='1', optimizer='Adagrad', regularization_coefficient=20.0, regularizer=2.0, resume_from_save=None, s
ave_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_bothNegSep run on wn18 starting from 2020-04-30 03:51:30.347489', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp
/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} crossentropy_loss_bothNegSep run on wn18 starting from 2020-04-30 03:51:30.347489', verbose=1)
Eval on valid |**********| 100.0% |M| mrr:93.66|h10:94.60%|h1:93.03|e1| mrr:93.69|h10:94.54%|h1:93.08|e2| mrr:93.63|h10:94.66%|h1:92.98|time    12|TP-s error 6.920 |TP-o error 7.020 |
Eval on test  |**********| 100.0% |M| mrr:93.80|h10:94.77%|h1:93.24|e1| mrr:93.78|h10:94.84%|h1:93.16|e2| mrr:93.82|h10:94.70%|h1:93.32|time    12|TP-s error 6.840 |TP-o error 6.680 

softmax WO pos denom:
CUDA_VISIBLE_DEVICES=0 python3 main.py -d wn18 -m complex -a '{"embedding_dim":2000, "batch_norm":0, "unit_reg":0}' -l softmax_loss_wopos -r 0.1 -g 20 -b 100 -x 10000 -n 200 -v 1 -q 1 -y 10 -g_reg 2 -e 200
Eval on valid |**********| 100.0% |M| mrr:82.11|h10:92.35%|h1:76.24|e1| mrr:82.26|h10:92.48%|h1:76.40|e2| mrr:81.95|h10:92.22%|h1:76.08|time    11|TP-s error 23.600 |TP-o error 23.920 |
Eval on test  |**********| 100.0% |M| mrr:82.85|h10:92.90%|h1:77.19|e1| mrr:82.78|h10:93.02%|h1:77.04|e2| mrr:82.92|h10:92.78%|h1:77.34|time    11|TP-s error 22.960 |TP-o error 22.660 ||
Namespace(avg_scores=0, batch_norm=0, batch_size=100, data_repository_root='data', dataset='wn18', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='softmax_loss_wopos', max_epochs
=200, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=200, oov_entity='1', optimizer='Adagrad', regularization_coefficient=20.0, regularizer=2.0, resume_from_save=None, save_dir='/
home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0, "unit_reg":0} softmax_loss_wopos run on wn18 starting from 2020-04-30 23:12:54.066308', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embe
dding_dim":2000, "batch_norm":0, "unit_reg":0} softmax_loss_wopos run on wn18 starting from 2020-04-30 23:12:54.066308', verbose=1)

@@@@@@<SimplIE>:FSM@@@@@ #re-running@
main.py -d wn18 -m SimplIE -a {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} -l crossentropy_loss_AllNeg -r 0.05 -g 2 -b 3000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 1 -avg 1
Eval on valid |**********| 100.0% |M| mrr:94.84|h10:95.46%|h1:94.50|e1| mrr:94.79|h10:95.38%|h1:94.46|e2| mrr:94.90|h10:95.54%|h1:94.54
Eval on test  |**********| 100.0% |M| mrr:94.87|h10:95.50%|h1:94.51|e1| mrr:94.90|h10:95.60%|h1:94.48|e2| mrr:94.85|h10:95.40%|h1:94.54|

@@@@@@<SimplIE>:FSM: Asymmetric@@@@@@
main.py -d wn18 -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.05 -g 2 -b 4000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 0 -msg "bug fixed-now avg will add both e1,r,? and ?,r,e2"
{'valid_m': {'mrr': tensor(0.9495, device='cuda:0'), 'mr': tensor(591.1696, device='cuda:0'), 'hits10': tensor(0.9566, device='cuda:0'), 'hits1': tensor(0.9455, device='cuda:0')}, 'test_m': {'mrr': tensor(0.9495, device='cuda:0'), 'mr': tensor(454.1203, device='cuda:0'), 'hits10': tensor(0.9566, device='cuda:0'), 'hits1': tensor(0.9455, device='cuda:0')}, 'valid': {'mrr': tensor(0.9501, device='cuda:0'), 'mr': tensor(588.7647, device='cuda:0'), 'hits10': tensor(0.9572, device='cuda:0'), 'hits1': tensor(0.9468, device='cuda:0')}, 'test': {'mrr': tensor(0.9494, device='cuda:0'), 'mr': tensor(459.8156, device='cuda:0'), 'hits10': tensor(0.9558, device='cuda:0'), 'hits1': tensor(0.9460, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.9488, device='cuda:0'), 'mr': tensor(593.5746, device='cuda:0'), 'hits10': tensor(0.9560, device='cuda:0'), 'hits1': tensor(0.9442, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.9495, device='cuda:0'), 'mr': tensor(448.4250, device='cuda:0'), 'hits10': tensor(0.9574, device='cuda:0'), 'hits1': tensor(0.9450, device='cuda:0')}}

@@@@@@<SimplIE>:FSM:Symmetric@@@@@@
main.py -d wn18 -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0. -g 2 -b 3000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1 -msg "bug fixed-now avg will add both e1,r,? and ?,r,e2" 
Eval on valid |M| mrr:94.84|h10:95.46%|h1:94.49|e1| mrr:94.76|h10:95.34%|h1:94.40|e2| mrr:94.93|h10:95.58%|h1:94.58|time     3|TP-s error 5.600 |TP-o error 5.420 |
Eval on test  |M| mrr:94.87|h10:95.56%|h1:94.47|e1| mrr:94.88|h10:95.74%|h1:94.40|e2| mrr:94.86|h10:95.38%|h1:94.54|time     3|TP-s error 5.600 |TP-o error 5.460 |
 


################################## WN18RR ##################################
@@@@@@<LX:Asymmetric>@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=1500, data_repository_root='data', dataset='wn18rr', debug=0, eval_batch_size=100, eval_every_x_mini_batches=100, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.01, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-09 11:33:27.173987', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-09 11:33:27.173987', verbose=1)
 valid_m {'mrr': tensor(0.4737, device='cuda:0'), 'mr': tensor(3898.8938, device='cuda:0'), 'hits10': tensor(0.5529, device='cuda:0'), 'hits1': tensor(0.4377, device='cuda:0')} test_m {'mrr': tensor(0.4737, device='cuda:0'), 'mr': tensor(3857.1658, device='cuda:0'), 'hits10': tensor(0.5536, device='cuda:0'), 'hits1': tensor(0.4355, device='cuda:0')} valid {'mrr': tensor(0.4932, device='cuda:0'), 'mr': tensor(2691.9443, device='cuda:0'), 'hits10': tensor(0.5732, device='cuda:0'), 'hits1': tensor(0.4555, device='cuda:0')} test {'mrr': tensor(0.4992, device='cuda:0'), 'mr': tensor(2578.3445, device='cuda:0'), 'hits10': tensor(0.5740, device='cuda:0'), 'hits1': tensor(0.4620, device='cuda:0')} valid_e1 {'mrr': tensor(0.4543, device='cuda:0'), 'mr': tensor(5105.8428, device='cuda:0'), 'hits10': tensor(0.5326, device='cuda:0'), 'hits1': tensor(0.4199, device='cuda:0')} test_e1 {'mrr': tensor(0.4482, device='cuda:0'), 'mr': tensor(5135.9863, device='cuda:0'), 'hits10': tensor(0.5332, device='cuda:0'), 'hits1': tensor(0.4091, device='cuda:0')}

@@@@@@<LX: Symmetric>@@@@@@
Namespace(avg_scores=1, batch_norm=0, batch_size=1500, data_repository_root='data', dataset='wn18rr', debug=0, eval_batch_size=100, eval_every_x_mini_batches=100, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='complex_lx', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.01, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-09 22:06:45.337839', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":2000, "batch_norm":0,"unit_reg":0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-09 22:06:45.337839', verbose=1)
Eval on valid |M| mrr:47.04|h10:54.80%|h1:43.51|e1| mrr:45.11|h10:52.93%|h1:41.66|e2| mrr:48.98|h10:56.66%|h1:45.35|TP-s error 58.339 |TP-o error 54.647 |
Eval on test  |M| mrr:46.88|h10:54.85%|h1:43.00|e1| mrr:44.62|h10:52.84%|h1:40.81|e2| mrr:49.15|h10:56.86%|h1:45.18|TP-s error 59.190 |TP-o error 54.818 |

@@@@@@<CX:FSM:L2>@@@@@@ #TO BE TUNED!!#may do more tuning
batch_size is imp
l2=0.1
b = 2000
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0}' -l crossentropy_loss_AllNeg -r 0.1 -g 2 -b 2000 -x 100 -n 0 -v 1 -q 1 -y 100 -g_reg 2 -inv 0 -avg 0
{'valid_m': {'mrr': tensor(0.4618, device='cuda:0'), 'mr': tensor(4545.4961, device='cuda:0'), 'hits10': tensor(0.5183, device='cuda:0'), 'hits1': tensor(0.4336, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4631, device='cuda:0'), 'mr': tensor(4592.1274, device='cuda:0'), 'hits10': tensor(0.5196, device='cuda:0'), 'hits1': tensor(0.4341, device='cuda:0')}, 'valid': {'mrr': tensor(0.4797, device='cuda:0'), 'mr': tensor(2794.5859, device='cuda:0'), 'hits10': tensor(0.5346, device='cuda:0'), 'hits1': tensor(0.4515, device='cuda:0')}, 'test': {'mrr': tensor(0.4850, device='cuda:0'), 'mr': tensor(2694.0544, device='cuda:0'), 'hi$s10': tensor(0.5345, device='cuda:0'), 'hits1': tensor(0.4579, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4440, device='cuda:0'), 'mr': tensor(6296.4058, device='cuda:0'), 'hits10': tensor(0.5020, device='$uda:0'), 'hits1': tensor(0.4156, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4412, device='cuda:0'), 'mr': tensor(6490.2002, device='cuda:0'), 'hits10': tensor(0.5048, device='cuda:0'), 'hits1': tensor(0.410$, device='cuda:0')}}

main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 5 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 200
{'valid_m': {'mrr': tensor(0.4629, device='cuda:0'), 'mr': tensor(4429.8931, device='cuda:0'), 'hits10': tensor(0.5267, device='cuda:0'), 'hits1': tensor(0.4295, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4647, device='cuda:0'), 'mr': tensor(4294.0298, device='cuda:0'), 'hits10': tensor(0.5345, device='cuda:0'), 'hits1': tensor(0.4296, device='cuda:0')}, 'valid': {'mrr': tensor(0.4829, device='cuda:0'), 'mr': tensor(2533.8098, device='cuda:0'), 'hits10': tensor(0.5389, device='cuda:0'), 'hits1': tensor(0.4512, device='cuda:0')}, 'test': {'mrr': tensor(0.4888, device='cuda:0'), 'mr': tensor(2293.5544, device='cuda:0'), 'hits10': tensor(0.5542, device='cuda:0'), 'hits1': tensor(0.4528, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4429, device='cuda:0'), 'mr': tensor(6325.9746, device='cuda:0'), 'hits10': tensor(0.5145, device='cuda:0'), 'hits1': tensor(0.4077, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4406, device='cuda:0'), 'mr': tensor(6294.5015, device='cuda:0'), 'hits10': tensor(0.5147, device='cuda:0'), 'hits1': tensor(0.4065, device='cuda:0')}}
[may try to train it for 400 epochs...was stopped a bit early!]

g=10
python3 main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 10 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 200
{'valid_m': {'mrr': tensor(0.4580, device='cuda:0'), 'mr': tensor(4480.1099, device='cuda:0'), 'hits10': tensor(0.5241, device='cuda:0'), 'hits1': tensor(0.4240, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4626, device='cuda:0'), 'mr': tensor(4392.9014, device='cuda:0'), 'hits10': tensor(0.5300, device='cuda:0'), 'hits1': tensor(0.4290, device='cuda:0')}, 'valid': {'mrr': tensor(0.4794, device='cuda:0'), 'mr': tensor(2438.0381, device='cuda:0'), 'hits10': tensor(0.5353, device='cuda:0'), 'hits1': tensor(0.4476, device='cuda:0')}, 'test': {'mrr': tensor(0.4892, device='cuda:0'), 'mr': tensor(2287.2566, device='cuda:0'), 'hits10': tensor(0.5498, device='cuda:0'), 'hits1': tensor(0.4566, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4366, device='cuda:0'), 'mr': tensor(6522.1816, device='cuda:0'), 'hits10': tensor(0.5129, device='cuda:0'), 'hits1': tensor(0.4005, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4360, device='cuda:0'), 'mr': tensor(6498.5425, device='cuda:0'), 'hits10': tensor(0.5102, device='cuda:0'), 'hits1': tensor(0.4014, device='cuda:0')}}

g=3
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 3 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 500
Eval on valid |M| mrr:46.50|h10:53.05%|h1:43.28|e1| mrr:44.50|h10:51.35%|h1:41.13|e2| mrr:48.50|h10:54.75%|h1:45.42|TP-s error 58.866 |TP-o error 54.581 |
Eval on test |M| mrr:46.58|h10:53.37%|h1:43.03|e1| mrr:44.20|h10:51.24%|h1:40.71|e2| mrr:48.96|h10:55.49%|h1:45.34|TP-s error 59.285 |TP-o error 54.659 |

g=4
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 4 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 200
Eval on valid |M| mrr:46.67|h10:53.39%|h1:43.38|e1| mrr:44.55|h10:52.04%|h1:41.07|e2| mrr:48.79|h10:54.75%|h1:45.68|TP-s error 58.932 |TP-o error 54.318 |
Eval on test  |M| mrr:46.75|h10:53.53%|h1:43.51|e1| mrr:44.22|h10:51.47%|h1:40.94|e2| mrr:49.28|h10:55.58%|h1:46.08|TP-s error 59.062 |TP-o error 53.925 |
batch_size=1k
{'valid_m': {'mrr': tensor(0.4666, device='cuda:0'), 'mr': tensor(4217.5337, device='cuda:0'), 'hits10': tensor(0.5318, device='cuda:0'), 'hits1': tensor(0.4341, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4676, device='cuda:0'), 'mr': tensor(4155.4033, device='cuda:0'), 'hits10': tensor(0.5439, device='cuda:0'), 'hits1': tensor(0.4317, device='cuda:0')}, 'valid': {'mrr': tensor(0.4867, device='cuda:0'), 'mr': tensor(2630.6460, device='cuda:0'), 'hits10': tensor(0.5481, device='cuda:0'), 'hits1': tensor(0.4552, device='cuda:0')}, 'test': {'mrr': tensor(0.4901, device='cuda:0'), 'mr': tensor(2486.5598, device='cuda:0'), 'hits10': tensor(0.5603, device='cuda:0'), 'hits1': tensor(0.4544, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4466, device='cuda:0'), 'mr': tensor(5804.4229, device='cuda:0'), 'hits10': tensor(0.5155, device='cuda:0'), 'hits1': tensor(0.4130, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4452, device='cuda:0'), 'mr': tensor(5824.2461, device='cuda:0'), 'hits10': tensor(0.5274, device='cuda:0'), 'hits1': tensor(0.4091, device='cuda:0')}}
 
g=5
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 5 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 200
Eval on valid |M| mrr:46.29|h10:52.67%|h1:42.95|e1| mrr:44.29|h10:51.45%|h1:40.77|e2| mrr:48.29|h10:53.89%|h1:45.12|TP-s error 59.229 |TP-o error 54.878 |
Eval on test |M| mrr:46.47|h10:53.45%|h1:42.96|e1| mrr:44.06|h10:51.47%|h1:40.65|e2| mrr:48.88|h10:55.42%|h1:45.28|TP-s error 59.349 |TP-o error 54.722 |
 
g=6 and b=1k
Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='wn18rr', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=400, message=None, model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=6.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-20 21:04:13.753670', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-20 21:04:13.753670', verbose=1)
Eval on valid |M| mrr:46.70|h10:53.36%|h1:43.34|e1| mrr:44.69|h10:51.65%|h1:41.27|e2| mrr:48.71|h10:55.08%|h1:45.42|TP-s error 58.734 |TP-o error 54.581 |
Eval on test  |M| mrr:46.83|h10:54.18%|h1:43.24|e1| mrr:44.40|h10:52.33%|h1:40.75|e2| mrr:49.25|h10:56.03%|h1:45.72|TP-s error 59.253 |TP-o error 54.276 |

g=0.001, b=2k (reg only by batch size) 
Namespace(avg_scores=0, batch_norm=0, batch_size=2000, data_repository_root='data', dataset='wn18rr', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=300, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.001, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-24 22:20:00.588226', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-24 22:20:00.588226', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.4657, device='cuda:0'), 'mr': tensor(4382.6606, device='cuda:0'), 'hits10': tensor(0.5328, device='cuda:0'), 'hits1': tensor(0.4329, device='cuda:0')} test_m {'mrr': tensor(0.4657, device='cuda:0'), 'mr': tensor(4509.5811, device='cuda:0'), 'hits10': tensor(0.5365, device='cuda:0'), 'hits1': tensor(0.4304, device='cuda:0')} valid {'mrr': tensor(0.4842, device='cuda:0'), 'mr': tensor(2757.0198, device='cuda:0'), 'hits10': tensor(0.5465, device='cuda:0'), 'hits1': tensor(0.4522, device='cuda:0')} test {'mrr': tensor(0.4901, device='cuda:0'), 'mr': tensor(2800.1533, device='cuda:0'), 'hits10': tensor(0.5574, device='cuda:0'), 'hits1': tensor(0.4563, device='cuda:0')} valid_e1 {'mrr': tensor(0.4471, device='cuda:0'), 'mr': tensor(6008.3018, device='cuda:0'), 'hits10': tensor(0.5191, device='cuda:0'), 'hits1': tensor(0.4136, device='cuda:0')} test_e1 {'mrr': tensor(0.4413, device='cuda:0'), 'mr': tensor(6219.0103, device='cuda:0'), 'hits10': tensor(0.5156, device='cuda:0'), 'hits1': tensor(0.4046, device='cuda:0')}

g=0.0001, b=2k (reg only by batch size) [cov aroun 700]
Namespace(avg_scores=0, batch_norm=0, batch_size=2000, data_repository_root='data', dataset='wn18rr', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=800, message='temp norm off:for embedding size', model='complex', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0001, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-25 12:29:43.120028', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-25 12:29:43.120028', verbose=1)
python main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.0001 -b 2000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 800  -msg 'temp norm off:for embedding size'
{'valid_m': {'mrr': tensor(0.4660, device='cuda:0'), 'mr': tensor(4653.5273, device='cuda:0'), 'hits10': tensor(0.5231, device='cuda:0'), 'hits1': tensor(0.4374, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4697, device='cuda:0'), 'mr': tensor(4690.5840, device='cuda:0'), 'hits10': tensor(0.5306, device='cuda:0'), 'hits1': tensor(0.4386, device='cuda:0')}, 'valid': {'mrr': tensor(0.4828, device='cuda:0'), 'mr': tensor(2703.9983, device='cuda:0'), 'hits10': tensor(0.5339, device='cuda:0'), 'hits1': tensor(0.4558, device='cuda:0')}, 'test': {'mrr': tensor(0.4900, device='cuda:0'), 'mr': tensor(2689.1174, device='cuda:0'), 'hits10': tensor(0.5456, device='cuda:0'), 'hits1': tensor(0.4601, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4492, device='cuda:0'), 'mr': tensor(6603.0532, device='cuda:0'), 'hits10': tensor(0.5122, device='cuda:0'), 'hits1': tensor(0.4189, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4494, device='cuda:0'), 'mr': tensor(6692.0479, device='cuda:0'), 'hits10': tensor(0.5156, device='cuda:0'), 'hits1': tensor(0.4170, device='cuda:0')}}

g=0.0005, b=2k (reg only by batch size)
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.0005 -b 2000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 800 -msg 'temp norm off:for embedding size'
{'valid_m': {'mrr': tensor(0.4657, device='cuda:0'), 'mr': tensor(4454.0732, device='cuda:0'), 'hits10': tensor(0.5283, device='cuda:0'), 'hits1': tensor(0.4347, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4683, device='cuda:0'), 'mr': tensor(4578.3433, device='cuda:0'), 'hits10': tensor(0.5324, device='cuda:0'), 'hits1': tensor(0.4349, device='cuda:0')}, 'valid': {'mrr': tensor(0.4849, device='cuda:0'), 'mr': tensor(2685.3235, device='cuda:0'), 'hits10': tensor(0.5422, device='cuda:0'), 'hits1': tensor(0.4552, device='cuda:0')}, 'test': {'mrr': tensor(0.4916, device='cuda:0'), 'mr': tensor(2749.7029, device='cuda:0'), 'hits10': tensor(0.5523, device='cuda:0'), 'hits1': tensor(0.4592, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4465, device='cuda:0'), 'mr': tensor(6222.8276, device='cuda:0'), 'hits10': tensor(0.5145, device='cuda:0'), 'hits1': tensor(0.4143, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4450, device='cuda:0'), 'mr': tensor(6406.9800, device='cuda:0'), 'hits10': tensor(0.5124, device='cuda:0'), 'hits1': tensor(0.4107, device='cuda:0')}}

g=0.00001, b=2k
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.00001 -b 2000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 800 -msg 'temp norm off:for embedding size'
{'valid_m': {'mrr': tensor(0.4614, device='cuda:0'), 'mr': tensor(4802.1089, device='cuda:0'), 'hits10': tensor(0.5199, device='cuda:0'), 'hits1': tensor(0.4324, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4664, device='cuda:0'), 'mr': tensor(4839.2754, device='cuda:0'), 'hits10': tensor(0.5255, device='cuda:0'), 'hits1': tensor(0.4370, device='cuda:0')}, 'valid': {'mrr': tensor(0.4765, device='cuda:0'), 'mr': tensor(2786.6167, device='cuda:0'), 'hits10': tensor(0.5300, device='cuda:0'), 'hits1': tensor(0.4486, device='cuda:0')}, 'test': {'mrr': tensor(0.4850, device='cuda:0'), 'mr': tensor(2733.8130, device='cuda:0'), 'hits10': tensor(0.5402, device='cuda:0'), 'hits1': tensor(0.4566, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4463, device='cuda:0'), 'mr': tensor(6817.5991, device='cuda:0'), 'hits10': tensor(0.5099, device='cuda:0'), 'hits1': tensor(0.4163, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4477, device='cuda:0'), 'mr': tensor(6944.7349, device='cuda:0'), 'hits10': tensor(0.5108, device='cuda:0'), 'hits1': tensor(0.4174, device='cuda:0')}}

g=0, b=2k
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0 -b 2000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -avg 0 -e 800 -msg 'temp norm off:for embedding size'
{'valid_m': {'mrr': tensor(0.4637, device='cuda:0'), 'mr': tensor(4813.4697, device='cuda:0'), 'hits10': tensor(0.5199, device='cuda:0'), 'hits1': tensor(0.4339, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4668, device='cuda:0'), 'mr': tensor(4888.4971, device='cuda:0'), 'hits10': tensor(0.5255, device='cuda:0'), 'hits1': tensor(0.4360, device='cuda:0')}, 'valid': {'mrr': tensor(0.4802, device='cuda:0'), 'mr': tensor(2782.7034, device='cuda:0'), 'hits10': tensor(0.5297, device='cuda:0'), 'hits1': tensor(0.4529, device='cuda:0')}, 'test': {'mrr': tensor(0.4866, device='cuda:0'), 'mr': tensor(2774.4490, device='cuda:0'), 'hits10': tensor(0.5392, device='cuda:0'), 'hits1': tensor(0.4569, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4472, device='cuda:0'), 'mr': tensor(6844.2344, device='cuda:0'), 'hits10': tensor(0.5102, device='cuda:0'), 'hits1': tensor(0.4150, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4470, device='cuda:0'), 'mr': tensor(7002.5415, device='cuda:0'), 'hits10': tensor(0.5118, device='cuda:0'), 'hits1': tensor(0.4151, device='cuda:0')}}

g=0.000005, b = 2k
46.68

@@@@@@<CX:FSM:L3>@@@@@@
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.1 -b 100 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 0 -avg 0 -e 300
{'valid_m': {'mrr': tensor(0.4858, device='cuda:0'), 'mr': tensor(2808.7349, device='cuda:0'), 'hits10': tensor(0.5756, device='cuda:0'), 'hits1': tensor(0.4441, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4872, device='cuda:0'), 'mr': tensor(2619.9805, device='cuda:0'), 'hits10': tensor(0.5801, device='cuda:0'), 'hits1': tensor(0.4435, device='cuda:0')}, 'valid': {'mrr': tensor(0.4993, device='cuda:0'), 'mr': tensor(1851.8887, device='cuda:0'), 'hits10': tensor(0.5953, device='cuda:0'), 'hits1': tensor(0.4555, device='cuda:0')}, 'test': {'mrr': tensor(0.5083, device='cuda:0'), 'mr': tensor(1717.4988, device='cuda:0'), 'hits10': tensor(0.6034, device='cuda:0'), 'hits1': tensor(0.4614, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4722, device='cuda:0'), 'mr': tensor(3765.5811, device='cuda:0'), 'hits10': tensor(0.5560, device='cuda:0'), 'hits1': tensor(0.4328, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4661, device='cuda:0'), 'mr': tensor(3522.4622, device='cuda:0'), 'hits10': tensor(0.5568, device='cuda:0'), 'hits1': tensor(0.4257, device='cuda:0')}}
Eval on valid |M| mrr:48.58|h10:57.56%|h1:44.41|e1| mrr:47.22|h10:55.60%|h1:43.28|e2| mrr:49.93|h10:59.53%|h1:45.55|TP-s error 56.724 |TP-o error 54.450 |
Eval on test  |M| mrr:48.72|h10:58.01%|h1:44.35|e1| mrr:46.61|h10:55.68%|h1:42.57|e2| mrr:50.83|h10:60.34%|h1:46.14|TP-s error 57.435 |TP-o error 53.861 |

@@@@@@<CX:WP:200neg>@@@@@@
<Still training!!>
main.py -d wn18rr -m complex -a '{"embedding_dim":2000, "batch_norm":0, "unit_reg":0}'  -l crossentropy_loss_bothNegSep -r 0.1 -g 0.0001 -b 500 -x 10000 -n 200 -v 1 -q 1 -y 10 -g_reg 2 -e 800  -msg 'temp norm off:for embedding size'
{'valid_m': {'mrr': tensor(0.4120, device='cuda:0'), 'mr': tensor(6092.5166, device='cuda:0'), 'hits10': tensor(0.4517, device='cuda:0'), 'hits1': tensor(0.3919, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4154, device='cuda:0'), 'mr': tensor(5923.8071, device='cuda:0'), 'hits10': tensor(0.4572, device='cuda:0'), 'hits1': tensor(0.3944, device='cuda:0')}, 'valid': {'mrr': tensor(0.4237, device='cuda:0'), 'mr': tensor(4131.1260, device='cuda:0'), 'hits10': tensor(0.4588, device='cuda:0'), 'hits1': tensor(0.4044, device='cuda:0')}, 'test': {'mrr': tensor(0.4322, device='cuda:0'), 'mr': tensor(3807.4109, device='cuda:0'), 'hits10': tensor(0.4706, device='cuda:0'), 'hits1': tensor(0.4123, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4003, device='cuda:0'), 'mr': tensor(8053.9062, device='cuda:0'), 'hits10': tensor(0.4446, device='cuda:0'), 'hits1': tensor(0.3794, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.3987, device='cuda:0'), 'mr': tensor(8040.2114, device='cuda:0'), 'hits10': tensor(0.4438, device='cuda:0'), 'hits1': tensor(0.3765, device='cuda:0')}}
 
@@@@@@<SimplIE>:FSM@@@@@@
Namespace(avg_scores=1, batch_norm=0, batch_size=4000, data_repository_root='data', dataset='wn18rr', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.05, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 2000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=2.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-08 15:48:33.329048', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on wn18rr starting from 2020-04-08 15:48:33.329048', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.4558, device='cuda:0'), 'mr': tensor(6124.0718, device='cuda:0'), 'hits10': tensor(0.5073, device='cuda:0'), 'hits1': tensor(0.4295, device='cuda:0')} test_m {'mrr': tensor(0.4571, device='cuda:0'), 'mr': tensor(6339.1245, device='cuda:0'), 'hits10': tensor(0.5195, device='cuda:0'), 'hits1': tensor(0.4279, device='cuda:0')} valid {'mrr': tensor(0.4710, device='cuda:0'), 'mr': tensor(5490.4126, device='cuda:0'), 'hits10': tensor(0.5152, device='cuda:0'), 'hits1': tensor(0.4469, device='cuda:0')} test {'mrr': tensor(0.4788, device='cuda:0'), 'mr': tensor(5791.4810, device='cuda:0'), 'hits10': tensor(0.5313, device='cuda:0'), 'hits1': tensor(0.4505, device='cuda:0')} valid_e1 {'mrr': tensor(0.4406, device='cuda:0'), 'mr': tensor(6757.7256, device='cuda:0'), 'hits10': tensor(0.4993, device='cuda:0'), 'hits1': tensor(0.4120, device='cuda:0')} test_e1 {'mrr': tensor(0.4354, device='cuda:0'), 'mr': tensor(6886.7661, device='cuda:0'), 'hits10': tensor(0.5077, device='cuda:0'), 'hits1': tensor(0.4052, device='cuda:0')}

@@@@@@<SimplIE>:FSM: Asymmetric@@@@@@ (very sensitive to batch size)
CUDA_VISIBLE_DEVICES=1 python3 main.py -d wn18rr -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.05 -g 2 -b 4000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 0
{'valid_m': {'mrr': tensor(0.4558, device='cuda:0'), 'mr': tensor(6124.0688, device='cuda:0'), 'hits10': tensor(0.5073, device='cuda:0'), 'hits1': tensor(0.4295, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4571, device='cuda:0'), 'mr': tensor(6339.1230, device='cuda:0'), 'hits10': tensor(0.5195, device='cuda:0'), 'hits1': tensor(0.4279, device='cuda:0')}, 'valid': {'mrr': tensor(0.4710, device='cuda:0'), 'mr': tensor(5490.4106, device='cuda:0'), 'hits10': tensor(0.5152, device='cuda:0'), 'hits1': tensor(0.4469, device='cuda:0')}, 'test': {'mrr': tensor(0.4788, device='cuda:0'), 'mr': tensor(5791.4810, device='cuda:0'), 'hits10': tensor(0.5313, device='cuda:0'), 'hits1': tensor(0.4505, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4406, device='cuda:0'), 'mr': tensor(6757.7256, device='cuda:0'), 'hits10': tensor(0.4993, device='cuda:0'), 'hits1': tensor(0.4120, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4354, device='cuda:0'), 'mr': tensor(6886.7661, device='cuda:0'), 'hits10': tensor(0.5077, device='cuda:0'), 'hits1': tensor(0.4052, device='cuda:0')}}

@@@@@@<SimplIE>:FSM:Symmetric@@@@@@
main.py -d wn18rr -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.05 -g 2 -b 3000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1 -msg "bug fixed-now avg will add both e1,r,? and ?,r,e2"
{'valid_m': {'mrr': tensor(0.4616, device='cuda:0'), 'mr': tensor(5364.4614, device='cuda:0'), 'hits10': tensor(0.5155, device='cuda:0'), 'hits1': tensor(0.4367, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4601, device='cuda:0'), 'mr': tensor(5267.6953, device='cuda:0'), 'hits10': tensor(0.5155, device='cuda:0'), 'hits1': tensor(0.4338, device='cuda:0')}, 'valid': {'mrr': tensor(0.4809, device='cuda:0'), 'mr': tensor(3756.7825, device='cuda:0'), 'hits10': tensor(0.5297, device='cuda:0'), 'hits1': tensor(0.4565, device='cuda:0')}, 'test': {'mrr': tensor(0.4822, device='cuda:0'), 'mr': tensor(3430.9141, device='cuda:0'), 'hits10': tensor(0.5294, device='cuda:0'), 'hits1': tensor(0.4588, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4423, device='cuda:0'), 'mr': tensor(6972.1436, device='cuda:0'), 'hits10': tensor(0.5013, device='cuda:0'), 'hits1': tensor(0.4169, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4380, device='cuda:0'), 'mr': tensor(7104.4795, device='cuda:0'), 'hits10': tensor(0.5016, device='cuda:0'), 'hits1': tensor(0.4087, device='cuda:0')}}


################################## YAGO3-10 ##################################
@@@@@@<LX>:Asymmetric@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=900, data_repository_root='data', dataset='yago', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=200, message=None, model='complex_lx', model_arguments={'embedding_dim': 1000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.005, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-13 12:42:20.406246', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex_lx {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-13 12:42:20.406246', verbose=1)
Eval on valid |M| mrr:57.64|h10:71.59%|h1:50.28|e1| mrr:42.90|h10:61.04%|h1:33.74|e2| mrr:72.38|h10:82.14%|h1:66.82|TP-s error 35.400 |TP-o error 11.540 | 
Eval on test  |M| mrr:57.31|h10:71.54%|h1:49.62|e1| mrr:43.06|h10:61.28%|h1:33.58|e2| mrr:71.55|h10:81.80%|h1:65.66|TP-s error 35.540 |TP-o error 12.400 |


@@@@@@<LX>:Symmetric@@@@@@
CUDA_VISIBLE_DEVICES=4 python3 main.py -d yago -m complex_lx -a '{"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.005 -b 900 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 1 -avg 1 -e 100
{'valid_m': {'mrr': tensor(0.5548, device='cuda:0'), 'mr': tensor(1267.7478, device='cuda:0'), 'hits10': tensor(0.7083, device='cuda:0'), 'hits1': tensor(0.4749, device='cuda:0')}, 'test_m': {'mrr': tensor(0.5495, device='cuda:0'), 'mr': tensor(1139.2091, device='cuda:0'), 'hits10': tensor(0.7071, device='cuda:0'), 'hits1': tensor(0.4665, device='cuda:0')}, 'valid': {'mrr': tensor(0.7141, device='cuda:0'), 'mr': tensor(475.9740, device='cuda:0'), 'hits10': tensor(0.8128, device='cuda:0'), 'hits1': tensor(0.6576, device='cuda:0')}, 'test': {'mrr': tensor(0.7071, device='cuda:0'), 'mr': tensor(428.6002, device='cuda:0'), 'hits10': tensor(0.8138, device='cuda:0'), 'hits1': tensor(0.6470, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.3955, device='cuda:0'), 'mr': tensor(2059.5217, device='cuda:0'), 'hits10': tensor(0.6038, device='cuda:0'), 'hits1': tensor(0.2922, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.3919, device='cuda:0'), 'mr': tensor(1849.8180, device='cuda:0'), 'hits10': tensor(0.6004, device='cuda:0'), 'hits1': tensor(0.2860, device='cuda:0')}}

main.py -d yago -m complex_lx -a '{"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}'  -l crossentropy_loss_AllNeg -r 0.1 -g 0.005 -b 900 -x 10000 -n 0 -v 1 -q 1 -y 10 -g_reg 3 -inv 1 -avg 1 -e 300
{'valid_m': {'mrr': tensor(0.5756, device='cuda:0'), 'mr': tensor(1248.8723, device='cuda:0'), 'hits10': tensor(0.7124, device='cuda:0'), 'hits1': tensor(0.5045, device='cuda:0')}, 'test_m': {'mrr': tensor(0.5740, device='cuda:0'), 'mr': tensor(1117.7570, device='cuda:0'), 'hits10': tensor(0.7144, device='cuda:0'), 'hits1': tensor(0.5003, device='cuda:0')}, 'valid': {'mrr': tensor(0.7186, device='cuda:0'), 'mr': tensor(478.0898, device='cuda:0'), 'hits10': tensor(0.8154, device='cuda:0'), 'hits1': tensor(0.6642, device='cuda:0')}, 'test': {'mrr': tensor(0.7140, device='cuda:0'), 'mr': tensor(421.2957, device='cuda:0'), 'hits10': tensor(0.8164, device='cuda:0'), 'hits1': tensor(0.6568, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4325, device='cuda:0'), 'mr': tensor(2019.6548, device='cuda:0'), 'hits10': tensor(0.6094, device='cuda:0'), 'hits1': tensor(0.3448, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4340, device='cuda:0'), 'mr': tensor(1814.2181, device='cuda:0'), 'hits10': tensor(0.6124, device='cuda:0'), 'hits1': tensor(0.3438, device='cuda:0')}}

@@@@@@<CX>:FSM:L3@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=900, data_repository_root='data', dataset='yago', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 1000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=0.0005, regularizer=3.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-13 15:02:14.410449', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-13 15:02:14.410449', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.5751, device='cuda:0'), 'mr': tensor(1233.9011, device='cuda:0'), 'hits10': tensor(0.7112, device='cuda:0'), 'hits1': tensor(0.5031, device='cuda:0')} test_m {'mrr': tensor(0.5773, device='cuda:0'), 'mr': tensor(1042.9957, device='cuda:0'), 'hits10': tensor(0.7117, device='cuda:0'), 'hits1': tensor(0.5061, device='cuda:0')} valid {'mrr': tensor(0.7156, device='cuda:0'), 'mr': tensor(423.6634, device='cuda:0'), 'hits10': tensor(0.8126, device='cuda:0'), 'hits1': tensor(0.6600, device='cuda:0')} test {'mrr': tensor(0.7133, device='cuda:0'), 'mr': tensor(365.9206, device='cuda:0'), 'hits10': tensor(0.8112, device='cuda:0'), 'hits1': tensor(0.6584, device='cuda:0')} valid_e1 {'mrr': tensor(0.4347, device='cuda:0'), 'mr': tensor(2044.1388, device='cuda:0'), 'hits10': tensor(0.6098, device='cuda:0'), 'hits1': tensor(0.3462, device='cuda:0')} test_e1 {'mrr': tensor(0.4413, device='cuda:0'), 'mr': tensor(1720.0712, device='cuda:0'), 'hits10': tensor(0.6122, device='cuda:0'), 'hits1': tensor(0.3538, device='cuda:0')}

@@@@@@<CX>:FSM:L2@@@@@@ very sensitive to reg coef - very low at 3 but fine at 2 :: epoch 66
main.py -d yago -m complex -a '{"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0. -g 2 -b 1500 -x 500 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 0 -e 500 -avg 0
Eval on valid |M| mrr:56.25|h10:70.75%|h1:48.75|e1| mrr:41.72|h10:60.60%|h1:32.24|e2| mrr:70.79|h10:80.90%|h1:65.26|TP-s error 33.900 |TP-o error 11.660 |
Eval on test  |M| mrr:56.09|h10:70.10%|h1:48.62|e1| mrr:41.83|h10:60.14%|h1:32.44|e2| mrr:70.35|h10:80.06%|h1:64.80|TP-s error 32.840 |TP-o error 12.060 ||
 

Namespace(avg_scores=0, batch_norm=0, batch_size=1000, data_repository_root='data', dataset='yago', debug=0, eval_batch_size=10, eval_every_x_mini_batches=10000, gradient_clip=None, hooks=[], inverse=0, learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=500, message=None, model='complex', model_arguments={'embedding_dim': 1000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=1.0, regularizer=2.0, resume_from_save=None, save_dir=
'/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-15 18:00:23.355312', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/complex {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-15 18:00:23.355312', verbose=1)
Eval on valid |M| mrr:57.78|h10:71.01%|h1:50.94|e1| mrr:43.89|h10:60.80%|h1:35.48|e2| mrr:71.67|h10:81.22%|h1:66.40| TP-s error 34.700 |TP-o error 11.980 |
Eval on test |M| mrr:57.51|h10:71.18%|h1:50.25|e1| mrr:43.68|h10:61.14%|h1:34.68|e2| mrr:71.33|h10:81.22%|h1:65.82|TP-s error 35.480 |TP-o error 11.740 ||

@@@@@@<SimplIE>:FSM@@@@@@
Namespace(avg_scores=1, batch_norm=0, batch_size=1500, data_repository_root='data', dataset='yago', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.05, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 1000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=2.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-08 15:34:17.905982', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-08 15:34:17.905982', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.5425, device='cuda:0'), 'mr': tensor(2180.9700, device='cuda:0'), 'hits10': tensor(0.6896, device='cuda:0'), 'hits1': tensor(0.4662, device='cuda:0')} test_m {'mrr': tensor(0.5415, device='cuda:0'), 'mr': tensor(2091.2964, device='cuda:0'), 'hits10': tensor(0.6884, device='cuda:0'), 'hits1': tensor(0.4636, device='cuda:0')} valid {'mrr': tensor(0.6839, device='cuda:0'), 'mr': tensor(1775.0543, device='cuda:0'), 'hits10': tensor(0.7868, device='cuda:0'), 'hits1': tensor(0.6250, device='cuda:0')} test {'mrr': tensor(0.6788, device='cuda:0'), 'mr': tensor(1773.1624, device='cuda:0'), 'hits10': tensor(0.7836, device='cuda:0'), 'hits1': tensor(0.6198, device='cuda:0')} valid_e1 {'mrr': tensor(0.4012, device='cuda:0'), 'mr': tensor(2586.8845, device='cuda:0'), 'hits10': tensor(0.5924, device='cuda:0'), 'hits1': tensor(0.3074, device='cuda:0')} test_e1 {'mrr': tensor(0.4042, device='cuda:0'), 'mr': tensor(2409.4304, device='cuda:0'), 'hits10': tensor(0.5932, device='cuda:0'), 'hits1': tensor(0.3074, device='cuda:0')}

@@@@@@<SimplIE>:FSM:Asymmetric@@@@@@
Namespace(avg_scores=0, batch_norm=0, batch_size=1500, data_repository_root='data', dataset='yago', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.05, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 1000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=2.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-09 11:41:34.460637', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-09 11:41:34.460637', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.5425, device='cuda:0'), 'mr': tensor(2180.9695, device='cuda:0'), 'hits10': tensor(0.6896, device='cuda:0'), 'hits1': tensor(0.4662, device='cuda:0')} test_m {'mrr': tensor(0.5415, device='cuda:0'), 'mr': tensor(2091.2957, device='cuda:0'), 'hits10': tensor(0.6884, device='cuda:0'), 'hits1': tensor(0.4636, device='cuda:0')} valid {'mrr': tensor(0.6839, device='cuda:0'), 'mr': tensor(1775.0542, device='cuda:0'), 'hits10': tensor(0.7868, device='cuda:0'), 'hits1': tensor(0.6250, device='cuda:0')} test {'mrr': tensor(0.6788, device='cuda:0'), 'mr': tensor(1773.1620, device='cuda:0'), 'hits10': tensor(0.7836, device='cuda:0'), 'hits1': tensor(0.6198, device='cuda:0')} valid_e1 {'mrr': tensor(0.4012, device='cuda:0'), 'mr': tensor(2586.8845, device='cuda:0'), 'hits10': tensor(0.5924, device='cuda:0'), 'hits1': tensor(0.3074, device='cuda:0')} test_e1 {'mrr': tensor(0.4042, device='cuda:0'), 'mr': tensor(2409.4294, device='cuda:0'), 'hits10': tensor(0.5932, device='cuda:0'), 'hits1': tensor(0.3074, device='cuda:0')}

@@@@@@<SimplIE>:FSM:Symmetric@@@@@@
main.py -d wn18rr -m SimplIE -a '{"embedding_dim":2000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.1 -g 2 -b 3000 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1 -msg "bug fixed-now avg will add both e1,r,? and ?,r,e2"
{'valid_m': {'mrr': tensor(0.4603, device='cuda:0'), 'mr': tensor(5113.6611, device='cuda:0'), 'hits10': tensor(0.5160, device='cuda:0'), 'hits1': tensor(0.4339, device='cuda:0')}, 'test_m': {'mrr': tensor(0.4592, device='cuda:0'), 'mr': tensor(5031.4956, device='cuda:0'), 'hits10': tensor(0.5156, device='cuda:0'), 'hits1': tensor(0.4301, device='cuda:0')}, 'valid': {'mrr': tensor(0.4812, device='cuda:0'), 'mr': tensor(3705.9907, device='cuda:0'), 'hits10': tensor(0.5316, device='cuda:0'), 'hits1': tensor(0.4552, device='cuda:0')}, 'test': {'mrr': tensor(0.4827, device='cuda:0'), 'mr': tensor(3509.3433, device='cuda:0'), 'hits10': tensor(0.5325, device='cuda:0'), 'hits1': tensor(0.4537, device='cuda:0')}, 'valid_e1': {'mrr': tensor(0.4394, device='cuda:0'), 'mr': tensor(6521.3296, device='cuda:0'), 'hits10': tensor(0.5003, device='cuda:0'), 'hits1': tensor(0.4127, device='cuda:0')}, 'test_e1': {'mrr': tensor(0.4356, device='cuda:0'), 'mr': tensor(6553.6475, device='cuda:0'), 'hits10': tensor(0.4987, device='cuda:0'), 'hits1': tensor(0.4065, device='cuda:0')}}
#
main.py -d yago -m SimplIE -a '{"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0}' -l crossentropy_loss_AllNeg -r 0.05 -g 2 -b 1100 -x 1000 -n 0 -v 1 -q 1 -y 10 -g_reg 2 -inv 1 -avg 1
Namespace(avg_scores=1, batch_norm=0, batch_size=1100, data_repository_root='data', dataset='yago', debug=0, eval_batch_size=10, eval_every_x_mini_batches=1000, gradient_clip=None, hooks=[], inverse=1, learning_rate=0.05, loss='crossentropy_loss_AllNeg', max_epochs=1000, message=None, model='SimplIE', model_arguments={'embedding_dim': 1000, 'batch_norm': 0, 'unit_reg': 0, 'clamp_v': 0.0}, negative_sample_count=0, oov_entity='1', optimizer='Adagrad', regularization_coefficient=2.0, regularizer=2.0, resume_from_save=None, save_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-10 16:17:08.181397', tflogs_dir='/home/prachi/scratch_shakuntala/softmax-exp/logs/SimplIE {"embedding_dim":1000, "batch_norm":0,"unit_reg":0, "clamp_v":0.0} crossentropy_loss_AllNeg run on yago starting from 2020-04-10 16:17:08.181397', verbose=1)
Best Model details:
 valid_m {'mrr': tensor(0.5574, device='cuda:0'), 'mr': tensor(1626.8334, device='cuda:0'), 'hits10': tensor(0.6943, device='cuda:0'), 'hits1': tensor(0.4843, device='cuda:0')} test_m {'mrr': tensor(0.5577, device='cuda:0'), 'mr': tensor(1468.5394, device='cuda:0'), 'hits10': tensor(0.6917, device='cuda:0'), 'hits1': tensor(0.4847, device='cuda:0')} valid {'mrr': tensor(0.7006, device='cuda:0'), 'mr': tensor(591.7997, device='cuda:0'), 'hits10': tensor(0.7996, device='cuda:0'), 'hits1': tensor(0.6454, device='cuda:0')} test {'mrr': tensor(0.7024, device='cuda:0'), 'mr': tensor(544.1727, device='cuda:0'), 'hits10': tensor(0.7928, device='cuda:0'), 'hits1': tensor(0.6490, device='cuda:0')} valid_e1 {'mrr': tensor(0.4142, device='cuda:0'), 'mr': tensor(2661.8667, device='cuda:0'), 'hits10': tensor(0.5890, device='cuda:0'), 'hits1': tensor(0.3232, device='cuda:0')} test_e1 {'mrr': tensor(0.4130, device='cuda:0'), 'mr': tensor(2392.9062, device='cuda:0'), 'hits10': tensor(0.5906, device='cuda:0'), 'hits1': tensor(0.3204, device='cuda:0')}

